# WinSrvUtil

Windows Server を作るときに使うやつセット。

pwsh.bat は powershell のラッパーである。
カレントディレクトリを移動し、与えられた引数をそのまま powershell に引き渡し、powershell の終了コードを返す。
たまに powershell との連携が下手なアプリが存在するため間に挟むために利用する。

EvtLog_Get.ps1 は、昨日分のイベントログをエクスポートして、テキスト変換した上で圧縮している。
イベントログはサーバ上でテキストに変換しないと見れなくなることがあるためテキスト変換は必須。

PerfLog_Rotate.ps1 は、パフォーマンスログの記録を一時停止して起動し直す。
パフォーマンスログはスケジュール機能がイケてなく、サーバを再起動したタイミングでログ切替の周期がずれる。
そのためジョブで一日の終わりに停止・起動してログの区切りをつけることをよくやる。
尚、パフォーマンスログのデータコレクタセットは定義済みである必要がある。

common\PSLogger.ps1 は、モジュールのような名前をしているが、ただの関数のセット。
ps1 から共通でロードされる。
